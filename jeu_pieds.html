<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Le jeu des pieds- Satureja path</title>

<style>
  body {
    font-family: sans-serif;
    text-align: center;
  }

  .container-haut {
    display: flex;
    justify-content: center;
    gap: 20px;
    margin: 20px;
  }

  .container-bas {
    display: flex;
    justify-content: center;
    gap: 20px;
    margin-top: 100px;
  }

  .point {
    position: absolute;
    left: 50%;
    width: 20px;
    height: 20px;
    border: 2px solid #ccc;
    border-radius: 8px;
    background-size: cover;
    background-position: center;
    cursor: pointer;
  }

  /* coche en haut */
#objects .point {
  top: -10px; /* décalage vers le haut */
  transform: translateX(-50%);
}

/* coche en bas */
#persons .point {
  bottom: -10px; /* décalage vers le bas */
  transform: translateX(-50%);
}

  .item {
    position: relative;
    display: inline-block;
  }
  
  .portrait img {
    width: 150px;
    heigth: auto;
  }

  .button-text {
    background-color: blue;
  }
</style>

<meta charset="utf-8">
        <title>messyflowerzz - Satureja path</title> 
        <link rel="stylesheet" href="style.css">
        <link rel="icon" href="images/favicon.ico" type="image/x-icon">
        <link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Ballet:opsz@16..72&family=Jacquarda+Bastarda+9&family=Rubik:ital,wght@0,300..900;1,300..900&family=Space+Mono:ital,wght@0,400;0,700;1,400;1,700&display=swap" rel="stylesheet">
</head>
<body>

<h1 style="text-align:center; margin-bottom:20px;">Relie les pieds à leur propriétaire</h1>


  <div class="container-haut" id="persons">
    <div class="item"><div class="portrait"><img src="images/portraits/anthea.jpg"></div><div class="point" data-id="Anthea"></div></div>
    <div class="item"><div class="portrait"><img src="images/portraits/bullefesse.jpg"></div><div class="point" data-id="Bullefesse"></div></div>
    <div class="item"><div class="portrait"><img src="images/portraits/cyril.jpg"></div><div class="point" data-id="Cyril"></div></div>
    <div class="item"><div class="portrait"><img src="images/portraits/hippo.jpg"></div><div class="point" data-id="Hippo"></div></div>
    <div class="item"><div class="portrait"><img src="images/portraits/hugot.jpg"></div><div class="point" data-id="Hugo"></div></div>
    <div class="item"><div class="portrait"><img src="images/portraits/jasmine.jpg"></div><div class="point" data-id="Jasmine"></div></div>
    <!-- <div class="item"><div class="point" data-id="Kévin"></div><img src="images/portraits/kevin.jpg"></div>
    <div class="item"><div class="point" data-id="Laura"></div><img src="images/portraits/laura.jpg"></div>
    <div class="item"><div class="point" data-id="Laureu"></div><img src="images/portraits/laureu.jpg"></div>
    <div class="item"><div class="point" data-id="Louise"></div><img src="images/portraits/louise.jpg"></div>
    <div class="item"><div class="point" data-id="MaloL"></div><img src="images/portraits/malol.jpg"></div>
    <div class="item"><div class="point" data-id="Mateo"></div><img src="images/portraits/mateo.jpg"></div>
    <div class="item"><div class="point" data-id="Maxime"></div><img src="images/portraits/maxime.jpg"></div>
    <div class="item"><div class="point" data-id="Raph"></div><img src="images/portraits/raph.jpg"></div>
    <div class="item"><div class="point" data-id="Thomas"></div><img src="images/portraits/thomas.jpg"></div>
    <div class="item"><div class="point" data-id="Titouan"></div><img src="images/portraits/titouan.jpg"></div>
    <div class="item"><div class="point" data-id="Yann"></div><img src="images/portraits/yann.jpg"></div> -->
  </div>

  <!-- SVG pour tracer les lignes -->
<svg id="lines" style="position:absolute; top:0; left:0; pointer-events:none;"></svg>

<!-- Images du bas (objets) -->
<div class="container-bas" id="objects">
  <div class="item"><div class="point" data-id="f-anthea"></div><div class="portrait"><img src="images/portraits/anthea.jpg"></div></div>
    <div class="item"><div class="point" data-id="f-bullefesse"></div><div class="portrait"><img src="images/portraits/bullefesse.jpg"></div></div>
    <div class="item"><div class="point" data-id="f-cyril"></div><div class="portrait"><img src="images/portraits/cyril.jpg"></div></div>
    <div class="item"><div class="point" data-id="f-hippo"></div><div class="portrait"><img src="images/portraits/hippo.jpg"></div></div>
    <div class="item"><div class="point" data-id="f-hugo"></div><div class="portrait"><img src="images/portraits/hugot.jpg"></div></div>
    <div class="item"><div class="point" data-id="f-jasmine"></div><div class="portrait"><img src="images/portraits/jasmine.jpg"></div></div>
</div>

<!-- Score -->
<h3 id="score"></h3>

<!-- Boutons -->
<div style="margin:20px;">
  <button id="check"><div class="button-text">Vérifier</div></button>
  <button onclick="location.reload()"><div class="button-text">Recommencer</div></button>
</div>

<script>
const svg = document.getElementById('lines');
let selectedPoint = null;
let connections = [];

// Réponses correctes (personne -> objet)
const correctPairs = {
  Anthea: 'f-anthea',
  Bullefesse: 'f-bullefesse',
  Cyril: 'f-cyril',
  Hippo: 'f-hippo',
  Hugo: 'f-hugo',
  Jasmine: 'f-jasmine'
};

function getPointCenter(el) {
  const rect = el.getBoundingClientRect();
  return {
    x: rect.left + rect.width / 2 + window.scrollX,
    y: rect.top + rect.height / 2 + window.scrollY
  };
}

function drawConnections(checking = false) {
  svg.innerHTML = '';
  svg.setAttribute('width', document.body.scrollWidth);
  svg.setAttribute('height', document.body.scrollHeight);

  connections.forEach(conn => {
    const p1 = getPointCenter(conn.from);
    const p2 = getPointCenter(conn.to);
    const dx = (p2.x - p1.x) / 2;
    const pathData = `M${p1.x},${p1.y} C${p1.x+dx},${p1.y} ${p2.x-dx},${p2.y} ${p2.x},${p2.y}`;
    const path = document.createElementNS('http://www.w3.org/2000/svg', 'path');
    path.setAttribute('d', pathData);
    path.setAttribute('stroke-width', 3);
    path.setAttribute('fill', 'none');

    if (checking) {
      const fromId = conn.from.dataset.id;
      const toId = conn.to.dataset.id;
      path.setAttribute('stroke', correctPairs[fromId] === toId ? 'green' : 'red');
    } else {
      path.setAttribute('stroke', 'blue');
    }
    svg.appendChild(path);
  });
}

let tempPath = null;

// Gestion clics (avec courbe qui suit la souris)
document.querySelectorAll('.point').forEach(point => {
  point.addEventListener('click', () => {
    if (!selectedPoint) {
      // Premier point sélectionné
      selectedPoint = point;
      point.style.outline = '3px solid green';

      // Crée une courbe temporaire
      const start = getPointCenter(selectedPoint);
      tempPath = document.createElementNS('http://www.w3.org/2000/svg', 'path');
      tempPath.setAttribute('stroke', 'blue');
      tempPath.setAttribute('stroke-width', 3);
      tempPath.setAttribute('fill', 'none');
      svg.appendChild(tempPath);

      // Suit la souris
      window.addEventListener('mousemove', followMouse);
    } else {
      // On doit relier un point du haut avec un du bas
      if (selectedPoint.closest('#persons') !== point.closest('#persons')) {
        connections.push({ from: selectedPoint, to: point });
        selectedPoint.style.outline = 'none';
        selectedPoint = null;
        drawConnections();
      }

      // Supprime le path temporaire
      if (tempPath) {
        svg.removeChild(tempPath);
        tempPath = null;
      }
      window.removeEventListener('mousemove', followMouse);
    }
  });
});

function followMouse(e) {
  if (!tempPath || !selectedPoint) return;
  const p1 = getPointCenter(selectedPoint);
  const p2 = { x: e.pageX, y: e.pageY };
  const dx = (p2.x - p1.x) / 2;
  const pathData = `M${p1.x},${p1.y} C${p1.x+dx},${p1.y} ${p2.x-dx},${p2.y} ${p2.x},${p2.y}`;
  tempPath.setAttribute('d', pathData);
}

// Bouton "Vérifier"
document.getElementById('check').addEventListener('click', () => {
  let score = 0;
  connections.forEach(conn => {
    const fromId = conn.from.dataset.id;
    const toId = conn.to.dataset.id;
    if (correctPairs[fromId] === toId) {
      score++;
    }
  });
  drawConnections(true);
  document.getElementById('score').textContent = `Score : ${score} / ${Object.keys(correctPairs).length}`;
});

// Ajuster les lignes au scroll/resize
window.addEventListener('scroll', () => drawConnections());
window.addEventListener('resize', () => drawConnections());
</script>
 


</body>
</html>
